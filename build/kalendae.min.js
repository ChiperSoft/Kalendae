/********************************************************************
 *	Kalendae, a framework agnostic javascript date picker           *
 *	Copyright(c) 2012 Jarvis Badgley (chipersoft@gmail.com)         *
 *	http://github.com/ChiperSoft/Kalendae                           *
 *	Version 0.2                                                     *
 ********************************************************************/

/********************************************************************
 *	Kalendae, a framework agnostic javascript date picker           *
 *	Copyright(c) 2012 Jarvis Badgley (chipersoft@gmail.com)         *
 *	http://github.com/ChiperSoft/Kalendae                           *
 *	Version 0.2                                                     *
 ********************************************************************/(function(e){var t,n=function(e,t){var n=!1;try{n=e instanceof Element}catch(i){n=!!e&&n.nodeType===1}!n&&typeof e!="string"&&(t=e);var a=this,f=a.classes,l=a.settings=s.merge(a.defaults,{attachTo:e},t||{}),c=a.container=s.make("div",{"class":f.container}),h=a.calendars=[],p=u().day(l.weekStart),d,v=[],m,g,y,b,w,E=[],S,x=0,T=l.months;s.isIE8()&&s.addClassName(c,"ie8"),x=7;while(x--)v.push(p.format("ddd").substr(0,l.columnHeaderLength)),p.add("days",1);o(a);if(typeof l.subscribe=="object")for(x in l.subscribe)l.subscribe.hasOwnProperty(x)&&a.subscribe(x,l.subscribe[x]);a._sel=[],!l.selected||a.setSelected(l.selected,!1),l.viewStartDate?d=u(l.viewStartDate,l.format):a._sel.length>0?d=u(a._sel[0]):d=u(),a.viewStartDate=d.date(1);var N={past:l.months-1,"today-past":l.months-1,any:l.months>2?Math.floor(l.months/2):0,"today-future":0,future:0}[this.settings.direction];N&&u().month()==u(a.viewStartDate).month()&&(a.viewStartDate=u(a.viewStartDate).subtract({M:N}).date(1));if(typeof l.blackout=="function")a.blackout=l.blackout;else if(!l.blackout)a.blackout=function(){return!1};else{var C=r(l.blackout,l.parseSplitDelimiter);a.blackout=function(e){e=u(e).yearDay();if(e<1||!a._sel||a._sel.length<1)return!1;var t=C.length;while(t--)if(C[t].yearDay()===e)return!0;return!1}}a.direction=a.directions[l.direction]?a.directions[l.direction]:a.directions.any,T=Math.max(l.months,1);while(T--){m=s.make("div",{"class":f.calendar},c),m.setAttribute("data-cal-index",T),l.months>1&&(T==Math.max(l.months-1,1)?s.addClassName(m,f.monthFirst):T===0?s.addClassName(m,f.monthLast):s.addClassName(m,f.monthMiddle)),g=s.make("div",{"class":f.title},m),s.make("a",{"class":f.previousYear},g),s.make("a",{"class":f.previousMonth},g),s.make("a",{"class":f.nextYear},g),s.make("a",{"class":f.nextMonth},g),y=s.make("span",{"class":f.caption},g),b=s.make("div",{"class":f.header},m),x=0;do S=s.make("span",{},b),S.innerHTML=v[x];while(++x<7);w=s.make("div",{"class":f.days},m),x=0,E=[];while(x++<42)E.push(s.make("span",{},w));h.push({caption:y,days:E}),T&&s.make("div",{"class":f.monthSeparator},c)}a.draw(),s.addEvent(c,"mousedown",function(e,t){var n;if(s.hasClassName(t,f.nextMonth))return!a.disableNext&&a.publish("view-changed",a,["next-month"])!==!1&&(a.viewStartDate.add("months",1),a.draw()),!1;if(s.hasClassName(t,f.previousMonth))return!a.disablePreviousMonth&&a.publish("view-changed",a,["previous-month"])!==!1&&(a.viewStartDate.subtract("months",1),a.draw()),!1;if(s.hasClassName(t,f.nextYear))return!a.disableNext&&a.publish("view-changed",a,["next-year"])!==!1&&(a.viewStartDate.add("years",1),a.draw()),!1;if(s.hasClassName(t,f.previousYear))return!a.disablePreviousMonth&&a.publish("view-changed",a,["previous-year"])!==!1&&(a.viewStartDate.subtract("years",1),a.draw()),!1;if(s.hasClassName(t.parentNode,f.days)&&s.hasClassName(t,f.dayActive)&&(n=t.getAttribute("data-date"))){n=u(n,l.dayAttributeFormat).hours(12);if(a.publish("date-clicked",a,[n])!==!1)switch(l.mode){case"multiple":a.addSelected(n)||a.removeSelected(n);break;case"range":a.addSelected(n);break;case"single":default:a.addSelected(n)}return!1}return!1}),!(l.attachTo=s.$(l.attachTo))||l.attachTo.appendChild(c)};n.prototype={defaults:{attachTo:null,months:1,weekStart:0,direction:"any",directionScrolling:!0,viewStartDate:null,blackout:null,selected:null,mode:"single",format:null,subscribe:null,columnHeaderLength:2,titleFormat:"MMMM, YYYY",dayNumberFormat:"D",dayAttributeFormat:"YYYY-MM-DD",parseSplitDelimiter:/,\s*|\s+-\s+/,rangeDelimiter:" - ",multipleDelimiter:", ",dateClassMap:{}},classes:{container:"kalendae",calendar:"k-calendar",monthFirst:"k-first-month",monthMiddle:"k-middle-month",monthLast:"k-last-month",title:"k-title",previousMonth:"k-btn-previous-month",nextMonth:"k-btn-next-month",previousYear:"k-btn-previous-year",nextYear:"k-btn-next-year",caption:"k-caption",header:"k-header",days:"k-days",dayOutOfMonth:"k-out-of-month",dayActive:"k-active",daySelected:"k-selected",dayInRange:"k-range",dayToday:"k-today",monthSeparator:"k-separator",disablePreviousMonth:"k-disable-previous-month-btn",disableNextMonth:"k-disable-next-month-btn",disablePreviousYear:"k-disable-previous-year-btn",disableNextYear:"k-disable-next-year-btn"},disablePreviousMonth:!1,disableNextMonth:!1,disablePreviousYear:!1,disableNextYear:!1,directions:{past:function(e){return u(e).yearDay()>=t.yearDay()},"today-past":function(e){return u(e).yearDay()>t.yearDay()},any:function(e){return!1},"today-future":function(e){return u(e).yearDay()<t.yearDay()},future:function(e){return u(e).yearDay()<=t.yearDay()}},getSelectedAsDates:function(){var e=[],t=0,n=this._sel.length;for(;t<n;t++)e.push(this._sel[t].toDate());return e},getSelectedAsText:function(e){var t=[],n=0,r=this._sel.length;for(;n<r;n++)t.push(this._sel[n].format(e||this.settings.format||"YYYY-MM-DD"));return t},getSelectedRaw:function(){var e=[],t=0,n=this._sel.length;for(;t<n;t++)e.push(u(this._sel[t]));return e},getSelected:function(e){var t=this.getSelectedAsText(e);switch(this.settings.mode){case"range":return t.splice(2),t.join(this.settings.rangeDelimiter);case"multiple":return t.join(this.settings.multipleDelimiter);case"single":default:return t[0]}},isSelected:function(e){e=u(e).yearDay();if(e<1||!this._sel||this._sel.length<1)return!1;switch(this.settings.mode){case"range":var t=this._sel[0]?this._sel[0].yearDay():0,n=this._sel[1]?this._sel[1].yearDay():0;if(t===e||n===e)return 1;if(!t||!n)return 0;if(e>t&&e<n||t<n&&e<t&&e>n)return-1;return!1;case"multiple":var r=this._sel.length;while(r--)if(this._sel[r].yearDay()===e)return!0;return!1;case"single":default:return this._sel[0]&&this._sel[0].yearDay()===e}return!1},setSelected:function(e,t){this._sel=r(e,this.settings.parseSplitDelimiter,this.settings.format),this._sel.sort(function(e,t){return e.yearDay()-t.yearDay()}),t!==!1&&this.draw()},addSelected:function(e,t){e=u(e).hours(12);switch(this.settings.mode){case"multiple":if(!!this.isSelected(e))return!1;this._sel.push(e);break;case"range":this._sel.length!==1?this._sel=[e]:e.yearDay()>this._sel[0].yearDay()?this._sel[1]=e:this._sel=[e,this._sel[0]];break;case"single":default:this._sel=[e]}return this._sel.sort(function(e,t){return e.yearDay()-t.yearDay()}),this.publish("change",this),t!==!1&&this.draw(),!0},removeSelected:function(e,t){e=u(e).yearDay();var n=this._sel.length;while(n--)if(this._sel[n].yearDay()===e)return this._sel.splice(n,1),this.publish("change",this),t!==!1&&this.draw(),!0;return!1},draw:function(){var n=u(this.viewStartDate).hours(12),r,i=this.classes,o,a,f,l=0,c,h=0,p,d,v,m=this.settings;c=this.calendars.length;do{r=u(n).date(1),r.day(r.day()<this.settings.weekStart?this.settings.weekStart-7:this.settings.weekStart),o=this.calendars[l],o.caption.innerHTML=n.format(this.settings.titleFormat),h=0;do a=o.days[h],f=[],d=this.isSelected(r),d&&f.push({"-1":i.dayInRange,1:i.daySelected,"true":i.daySelected}[d]),r.month()!=n.month()?f.push(i.dayOutOfMonth):(!this.blackout(r)&&!this.direction(r)||d>0)&&f.push(i.dayActive),r.yearDay()===t.yearDay()&&f.push(i.dayToday),v=r.format(this.settings.dayAttributeFormat),m.dateClassMap[v]&&f.push(m.dateClassMap[v]),a.innerHTML=r.format(m.dayNumberFormat),a.className=f.join(" "),a.setAttribute("data-date",v),r.add("days",1);while(++h<42);n.add("months",1)}while(++l<c);if(m.directionScrolling){var g=-u().diff(n,"months");if(m.direction==="today-past"||m.direction==="past")g<0?(this.disableNextMonth=!1,s.removeClassName(this.container,i.disableNextMonth)):(this.disableNextMonth=!0,s.addClassName(this.container,i.disableNextMonth));else if(m.direction==="today-future"||m.direction==="future")g>=m.months?(this.disablePreviousMonth=!1,s.removeClassName(this.container,i.disablePreviousMonth)):(this.disablePreviousMonth=!0,s.addClassName(this.container,i.disablePreviousMonth));if(m.direction==="today-past"||m.direction==="past")n.add({y:1}).diff(u(),"months")<=0?(this.disableNextYear=!1,s.removeClassName(this.container,i.disableNextYear)):(this.disableNextYear=!0,s.addClassName(this.container,i.disableNextYear));else if(m.direction==="today-future"||m.direction==="future")n.subtract({y:1}).diff(u(),"months")-(m.months-1)>=0?(this.disablePreviousYear=!1,s.removeClassName(this.container,i.disablePreviousYear)):(this.disablePreviousYear=!0,s.addClassName(this.container,i.disablePreviousYear))}}};var r=function(e,t,n){var r=[];typeof e=="string"?e=e.split(t):s.isArray(e)||(e=[e]);var o=e.length;i=0;do e[i]&&r.push(u(e[i],n).hours(12));while(++i<o);return r};window.Kalendae=n;var s=n.util={isIE8:function(){return!!(/msie 8./i.test(navigator.appVersion)&&!/opera/i.test(navigator.userAgent)&&window.ActiveXObject&&XDomainRequest&&!window.msPerformance)},$:function(e){return typeof e=="string"?document.getElementById(e):e},$$:function(e){return document.querySelectorAll(e)},make:function(e,t,n){var r,i=document.createElement(e);if(!!t)for(r in t)t.hasOwnProperty(r)&&i.setAttribute(r,t[r]);return!n||n.appendChild(i),i},isVisible:function(e){return e.offsetWidth>0||e.offsetHeight>0},getStyle:function(e,t){var n;return e.currentStyle?n=e.currentStyle[t]:window.getComputedStyle&&(n=window.getComputedStyle(e,null)[t]),n},domReady:function(e){/in/.test(document.readyState)?setTimeout(function(){s.domReady(e)},9):e()},addEvent:function(e,t,n){var r=function(t){t=t||window.event;var r=t.target||t.srcElement,i=n.apply(e,[t,r]);return i===!1&&(t.preventDefault?t.preventDefault():(t.returnValue=!1,t.cancelBubble=!0)),i};return e.attachEvent?e.attachEvent("on"+t,r):e.addEventListener(t,r,!1),r},removeEvent:function(e,t,n){e.detachEvent?e.detachEvent("on"+t,n):e.removeEventListener(t,n,!1)},hasClassName:function(e,t){if(!(e=s.$(e)))return!1;var n=e.className;return n.length>0&&(n==t||(new RegExp("(^|\\s)"+t+"(\\s|$)")).test(n))},addClassName:function(e,t){if(!(e=s.$(e)))return;s.hasClassName(e,t)||(e.className+=(e.className?" ":"")+t)},removeClassName:function(e,t){if(!(e=s.$(e)))return;e.className=s.trimString(e.className.replace(new RegExp("(^|\\s+)"+t+"(\\s+|$)")," "))},isFixed:function(e){do if(s.getStyle(e,"position")==="fixed")return!0;while(e=e.offsetParent);return!1},getPosition:function(e,t){var n=e.offsetLeft,r=e.offsetTop,i={};if(!t)while(e=e.offsetParent)n+=e.offsetLeft,r+=e.offsetTop;return i[0]=i.left=n,i[1]=i.top=r,i},getHeight:function(e){return e.offsetHeight||e.scrollHeight},getWidth:function(e){return e.offsetWidth||e.scrollWidth},trimString:function(e){return e.replace(/^\s+/,"").replace(/\s+$/,"")},merge:function(){var e=arguments[0]===!0,t={},n=e?1:0,r=function(t,n){if(typeof n!="object")return;for(var r in n)n.hasOwnProperty(r)&&(e&&typeof t[r]=="object"&&typeof n[r]=="object"?_update(t[r],n[r]):t[r]=n[r]);return t};for(;n<arguments.length;n++)r(t,arguments[n]);return t},isArray:function(e){return!(!e||!e.length||e.length===0||typeof e!="object"||!e.constructor||e.nodeType||e.item)}};n.util.domReady(function(){var e=s.$$(".auto-kal"),t=e.length,r;while(t--){r=e[t];var i=r.getAttribute("data-kal"),o=i==null||i==""?{}:(new Function("return {"+i+"};"))();console.log(o),r.tagName==="INPUT"?new n.Input(r,o):new n(s.merge({attachTo:r},o))}}),n.Input=function(e,t){var r=this.input=s.$(e),i;if(!r||r.tagName!=="INPUT")throw"First argument for Kalendae.Input must be an <input> element or a valid element id.";var o=this,u=o.classes;opts=o.settings=s.merge(o.defaults,t),opts.attachTo=window.document.body,opts.selected?i=!0:opts.selected=r.value,n.call(o,opts);if(opts.closeButton){var a=s.make("a",{"class":u.closeButton},o.container);s.addEvent(a,"click",function(){r.blur()})}i&&(r.value=o.getSelected());var f=o.container,l=!1;f.style.display="none",s.addClassName(f,u.positioned),s.addEvent(f,"mousedown",function(e,t){l=!0}),s.addEvent(window.document,"mousedown",function(e,t){l=!1}),s.addEvent(r,"focus",function(){o.setSelected(this.value),o.show()}),s.addEvent(r,"blur",function(){l?(l=!1,r.focus()):o.hide()}),s.addEvent(r,"keyup",function(e){o.setSelected(this.value)}),o.subscribe("change",function(){r.value=o.getSelected()})},n.Input.prototype=s.merge(n.prototype,{defaults:s.merge(n.prototype.defaults,{format:"MM/DD/YYYY",side:"bottom",closeButton:!0,offsetLeft:0,offsetTop:0}),classes:s.merge(n.prototype.classes,{positioned:"k-floating",closeButton:"k-btn-close"}),show:function(){var e=this.container,t=e.style,n=this.input,r=s.getPosition(n);t.display="";switch(opts.side){case"left":t.left=r.left-s.getWidth(e)+this.settings.offsetLeft+"px",t.top=r.top+this.settings.offsetTop+"px";break;case"right":t.left=r.left+s.getWidth(n)+"px",t.top=r.top+this.settings.offsetTop+"px";break;case"top":t.left=r.left+this.settings.offsetLeft+"px",t.top=r.top-s.getHeight(e)+this.settings.offsetTop+"px";break;case"bottom":default:t.left=r.left+this.settings.offsetLeft+"px",t.top=r.top+s.getHeight(n)+this.settings.offsetTop+"px"}t.position=s.isFixed(n)?"fixed":"absolute"},hide:function(){this.container.style.display="none"}});var o=function(e){e||(e=this);var t=e.c_||{};e.publish=function(e,n,r){var i=t[e],s=i?i.length:0,o;while(s--){o=i[s].apply(n,r||[]);if(typeof o=="boolean")return o}},e.subscribe=function(e,n,r){return t[e]||(t[e]=[]),r?t[e].push(n):t[e].unshift(n),[e,n]},e.unsubscribe=function(e){var n=t[e[0]],r=e[1],i=n?n.length:0;while(i--)n[i]===r&&n.splice(i,1)}},u=n.moment=function(e,t){function w(e,t){this._d=e,this._isUTC=!!t}function E(e,t){var n=e+"";while(n.length<t)n="0"+n;return n}function S(t,n,r,i){var s=typeof n=="string",o=s?{}:n,u,a,f,l;return s&&i&&(o[n]=+i),u=(o.ms||o.milliseconds||0)+(o.s||o.seconds||0)*1e3+(o.m||o.minutes||0)*6e4+(o.h||o.hours||0)*36e5,a=(o.d||o.days||0)+(o.w||o.weeks||0)*7,f=(o.M||o.months||0)+(o.y||o.years||0)*12,u&&t.setTime(+t+u*r),a&&t.setDate(t.getDate()+a*r),f&&(l=t.getDate(),t.setDate(1),t.setMonth(t.getMonth()+f*r),t.setDate(Math.min((new e(t.getFullYear(),t.getMonth()+1,0)).getDate(),l))),t}function x(e){return Object.prototype.toString.call(e)==="[object Array]"}function T(t){return new e(t[0],t[1]||0,t[2]||1,t[3]||0,t[4]||0,t[5]||0,t[6]||0)}function N(t,r){function g(r){var f,y;switch(r){case"M":return i+1;case"Mo":return i+1+v(i+1);case"MM":return E(i+1,2);case"MMM":return n.monthsShort[i];case"MMMM":return n.months[i];case"D":return s;case"Do":return s+v(s);case"DD":return E(s,2);case"DDD":return f=new e(o,i,s),y=new e(o,0,1),~~((f-y)/864e5+1.5);case"DDDo":return f=g("DDD"),f+v(f);case"DDDD":return E(g("DDD"),3);case"d":return u;case"do":return u+v(u);case"ddd":return n.weekdaysShort[u];case"dddd":return n.weekdays[u];case"w":return f=new e(o,i,s-u+5),y=new e(f.getFullYear(),0,4),~~((f-y)/864e5/7+1.5);case"wo":return f=g("w"),f+v(f);case"ww":return E(g("w"),2);case"YY":return E(o%100,2);case"YYYY":return o;case"a":return a>11?m.pm:m.am;case"A":return a>11?m.PM:m.AM;case"H":return a;case"HH":return E(a,2);case"h":return a%12||12;case"hh":return E(a%12||12,2);case"m":return h;case"mm":return E(h,2);case"s":return p;case"ss":return E(p,2);case"zz":case"z":return(t._d.toString().match(c)||[""])[0].replace(l,"");case"Z":return(d<0?"-":"+")+E(~~(Math.abs(d)/60),2)+":"+E(~~(Math.abs(d)%60),2);case"ZZ":return(d<0?"-":"+")+E(~~(10*Math.abs(d)/6),4);case"L":case"LL":case"LLL":case"LLLL":case"LT":return N(t,n.longDateFormat[r]);default:return r.replace(/(^\[)|(\\)|\]$/g,"")}}var i=t.month(),s=t.date(),o=t.year(),u=t.day(),a=t.hours(),h=t.minutes(),p=t.seconds(),d=-t.zone(),v=n.ordinal,m=n.meridiem;return r.replace(f,g)}function C(t,r){function v(e,t){var r;switch(e){case"M":case"MM":i[1]=~~t-1;break;case"MMM":case"MMMM":for(r=0;r<12;r++)if(n.monthsParse[r].test(t)){i[1]=r;break}break;case"D":case"DD":case"DDD":case"DDDD":i[2]=~~t;break;case"YY":t=~~t,i[0]=t+(t>70?1900:2e3);break;case"YYYY":i[0]=~~Math.abs(t);break;case"a":case"A":d=t.toLowerCase()==="pm";break;case"H":case"HH":case"h":case"hh":i[3]=~~t;break;case"m":case"mm":i[4]=~~t;break;case"s":case"ss":i[5]=~~t;break;case"Z":case"ZZ":u=!0,r=(t||"").match(g),r&&r[1]&&(s=~~r[1]),r&&r[2]&&(o=~~r[2]),r&&r[0]==="+"&&(s=-s,o=-o)}}var i=[0,0,1,0,0,0,0],s=0,o=0,u=!1,a=t.match(p),f=r.match(h),l=Math.min(a.length,f.length),c,d;for(c=0;c<l;c++)v(f[c],a[c]);return d&&i[3]<12&&(i[3]+=12),d===!1&&i[3]===12&&(i[3]=0),i[3]+=s,i[4]+=o,u?new e(e.UTC.apply({},i)):T(i)}function k(e,t){var n=Math.min(e.length,t.length),r=Math.abs(e.length-t.length),i=0,s;for(s=0;s<n;s++)~~e[s]!==~~t[s]&&i++;return i+r}function L(e,t){var n,r=e.match(p),i=[],s=99,o,u,a;for(o=0;o<t.length;o++)u=C(e,t[o]),a=k(r,N(new w(u),t[o]).match(p)),a<s&&(s=a,n=u);return n}function A(t){var n="YYYY-MM-DDT",r;if(d.exec(t)){for(r=0;r<3;r++)if(m[r][1].exec(t)){n+=m[r][0];break}return C(t,n+"Z")}return new e(t)}function O(e,t,r){var i=n.relativeTime[e];return typeof i=="function"?i(t||1,!!r,e):i.replace(/%d/i,t||1)}function M(e,t){var n=r(Math.abs(e)/1e3),i=r(n/60),s=r(i/60),o=r(s/24),u=r(o/365),a=n<45&&["s",n]||i===1&&["m"]||i<45&&["mm",i]||s===1&&["h"]||s<22&&["hh",s]||o===1&&["d"]||o<=25&&["dd",o]||o<=45&&["M"]||o<345&&["MM",r(o/30)]||u===1&&["y"]||["yy",u];return a[2]=t,O.apply({},a)}function _(e,t){n.fn[e]=function(e){var n=this._isUTC?"UTC":"";return typeof e!="undefined"?(this._d["set"+n+t](e),this):this._d["get"+n+t]()}}var n,r=Math.round,i={},s=typeof module!="undefined",o="months|monthsShort|monthsParse|weekdays|weekdaysShort|longDateFormat|calendar|relativeTime|ordinal|meridiem".split("|"),u,a=/^\/?Date\((\-?\d+)/i,f=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|dddd?|do?|w[o|w]?|YYYY|YY|a|A|hh?|HH?|mm?|ss?|zz?|ZZ?|LT|LL?L?L?)/g,l=/[^A-Z]/g,c=/\([A-Za-z ]+\)|:[0-9]{2} [A-Z]{3} /g,h=/(\\)?(MM?M?M?|dd?d?d|DD?D?D?|YYYY|YY|a|A|hh?|HH?|mm?|ss?|ZZ?|T)/g,p=/(\\)?([0-9]+|([a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+|([\+\-]\d\d:?\d\d))/gi,d=/\d{4}.\d\d.\d\d(T(\d\d(.\d\d(.\d\d)?)?)?([\+\-]\d\d:?\d\d)?)?/,v="YYYY-MM-DDTHH:mm:ssZ",m=[["HH:mm:ss",/T\d\d:\d\d:\d\d/],["HH:mm",/T\d\d:\d\d/],["HH",/T\d\d/]],g=/([\+\-]|\d\d)/gi,y="1.5.0",b="Month|Date|Hours|Minutes|Seconds|Milliseconds".split("|");n=function(n,r){if(n===null||n==="")return null;var i,s;return n&&n._d instanceof e?i=new e(+n._d):r?x(r)?i=L(n,r):i=C(n,r):(s=a.exec(n),i=n===t?new e:s?new e(+s[1]):n instanceof e?n:x(n)?T(n):typeof n=="string"?A(n):new e(n)),new w(i)},n.utc=function(t,r){return x(t)?new w(new e(e.UTC.apply({},t)),!0):r&&t?n(t+" 0",r+" Z").utc():n(t).utc()},n.humanizeDuration=function(e,t,r){var i=+e,s=n.relativeTime,o;switch(t){case"seconds":i*=1e3;break;case"minutes":i*=6e4;break;case"hours":i*=36e5;break;case"days":i*=864e5;break;case"weeks":i*=6048e5;break;case"months":i*=2592e6;break;case"years":i*=31536e6;break;default:r=!!t}return o=M(i,!r),r?(i<=0?s.past:s.future).replace(/%s/i,o):o},n.version=y,n.defaultFormat=v,n.lang=function(e,t){var r,u,a,f=[];if(t){for(r=0;r<12;r++)f[r]=new RegExp("^"+t.months[r]+"|^"+t.monthsShort[r].replace(".",""),"i");t.monthsParse=t.monthsParse||f,i[e]=t}if(i[e])for(r=0;r<o.length;r++)u=o[r],n[u]=i[e][u]||n[u];else s&&(a=require("./lang/"+e),n.lang(e,a))},n.lang("en",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},meridiem:{AM:"AM",am:"am",PM:"PM",pm:"pm"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},ordinal:function(e){var t=e%10;return~~(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th"}}),n.isMoment=function(e){return e instanceof w},n.fn=w.prototype={clone:function(){return n(this)},valueOf:function(){return+this._d},"native":function(){return this._d},toString:function(){return this._d.toString()},toDate:function(){return this._d},utc:function(){return this._isUTC=!0,this},local:function(){return this._isUTC=!1,this},format:function(e){return N(this,e?e:n.defaultFormat)},add:function(e,t){return this._d=S(this._d,e,1,t),this},subtract:function(e,t){return this._d=S(this._d,e,-1,t),this},diff:function(e,t,i){var s=n(e),o=(this.zone()-s.zone())*6e4,u=this._d-s._d-o,a=this.year()-s.year(),f=this.month()-s.month(),l=this.date()-s.date(),c;return t==="months"?c=a*12+f+l/30:t==="years"?c=a+f/12:c=t==="seconds"?u/1e3:t==="minutes"?u/6e4:t==="hours"?u/36e5:t==="days"?u/864e5:t==="weeks"?u/6048e5:u,i?c:r(c)},from:function(e,t){return n.humanizeDuration(this.diff(e),!t)},fromNow:function(e){return this.from(n(),e)},calendar:function(){var e=this.diff(n().sod(),"days",!0),t=n.calendar,r=t.sameElse,i=e<-6?r:e<-1?t.lastWeek:e<0?t.lastDay:e<1?t.sameDay:e<2?t.nextDay:e<7?t.nextWeek:r;return this.format(typeof i=="function"?i.apply(this):i)},isLeapYear:function(){var e=this.year();return e%4===0&&e%100!==0||e%400===0},isDST:function(){return this.zone()<n([this.year()]).zone()||this.zone()<n([this.year(),5]).zone()},day:function(e){var t=this._d.getDay();return typeof e=="undefined"?t:this.add({d:e-t})},sod:function(){return this.clone().hours(0).minutes(0).seconds(0).milliseconds(0)},eod:function(){return this.sod().add({d:1,ms:-1})},zone:function(){return this._isUTC?0:this._d.getTimezoneOffset()},daysInMonth:function(){return this.clone().month(this.month()+1).date(0).date()}};for(u=0;u<b.length;u++)_(b[u].toLowerCase(),b[u]);return _("year","FullYear"),n}(Date);u.fn.stripTime=function(){return this._d=new Date(Math.floor(this._d.valueOf()/864e5)*864e5),this},u.fn.yearDay=function(e){var t=Math.floor(this._d/864e5);return typeof e=="undefined"?t:this.add({d:e-t})},t=u().stripTime(),typeof jQuery!="undefined"&&(jQuery.fn.kalendae=function(e){return this.each(function(t,r){r.tagName==="INPUT"?$(r).data("kalendae",new n.Input(r,e)):$(r).data("kalendae",new n($.extend({},{attachTo:r},e)))}),this})})(),function(e){var t,n=function(e,t){var n=!1;try{n=e instanceof Element}catch(i){n=!!e&&n.nodeType===1}!n&&typeof e!="string"&&(t=e);var a=this,f=a.classes,l=a.settings=s.merge(a.defaults,{attachTo:e},t||{}),c=a.container=s.make("div",{"class":f.container}),h=a.calendars=[],p=u().day(l.weekStart),d,v=[],m,g,y,b,w,E=[],S,x=0,T=l.months;s.isIE8()&&s.addClassName(c,"ie8"),x=7;while(x--)v.push(p.format("ddd").substr(0,l.columnHeaderLength)),p.add("days",1);o(a);if(typeof l.subscribe=="object")for(x in l.subscribe)l.subscribe.hasOwnProperty(x)&&a.subscribe(x,l.subscribe[x]);a._sel=[],!l.selected||a.setSelected(l.selected,!1),l.viewStartDate?d=u(l.viewStartDate,l.format):a._sel.length>0?d=u(a._sel[0]):d=u(),a.viewStartDate=d.date(1);var N={past:l.months-1,"today-past":l.months-1,any:l.months>2?Math.floor(l.months/2):0,"today-future":0,future:0}[this.settings.direction];N&&u().month()==u(a.viewStartDate).month()&&(a.viewStartDate=u(a.viewStartDate).subtract({M:N}).date(1));if(typeof l.blackout=="function")a.blackout=l.blackout;else if(!l.blackout)a.blackout=function(){return!1};else{var C=r(l.blackout,l.parseSplitDelimiter);a.blackout=function(e){e=u(e).yearDay();if(e<1||!a._sel||a._sel.length<1)return!1;var t=C.length;while(t--)if(C[t].yearDay()===e)return!0;return!1}}a.direction=a.directions[l.direction]?a.directions[l.direction]:a.directions.any,T=Math.max(l.months,1);while(T--){m=s.make("div",{"class":f.calendar},c),m.setAttribute("data-cal-index",T),l.months>1&&(T==Math.max(l.months-1,1)?s.addClassName(m,f.monthFirst):T===0?s.addClassName(m,f.monthLast):s.addClassName(m,f.monthMiddle)),g=s.make("div",{"class":f.title},m),s.make("a",{"class":f.previousYear},g),s.make("a",{"class":f.previousMonth},g),s.make("a",{"class":f.nextYear},g),s.make("a",{"class":f.nextMonth},g),y=s.make("span",{"class":f.caption},g),b=s.make("div",{"class":f.header},m),x=0;do S=s.make("span",{},b),S.innerHTML=v[x];while(++x<7);w=s.make("div",{"class":f.days},m),x=0,E=[];while(x++<42)E.push(s.make("span",{},w));h.push({caption:y,days:E}),T&&s.make("div",{"class":f.monthSeparator},c)}a.draw(),s.addEvent(c,"mousedown",function(e,t){var n;if(s.hasClassName(t,f.nextMonth))return!a.disableNext&&a.publish("view-changed",a,["next-month"])!==!1&&(a.viewStartDate.add("months",1),a.draw()),!1;if(s.hasClassName(t,f.previousMonth))return!a.disablePreviousMonth&&a.publish("view-changed",a,["previous-month"])!==!1&&(a.viewStartDate.subtract("months",1),a.draw()),!1;if(s.hasClassName(t,f.nextYear))return!a.disableNext&&a.publish("view-changed",a,["next-year"])!==!1&&(a.viewStartDate.add("years",1),a.draw()),!1;if(s.hasClassName(t,f.previousYear))return!a.disablePreviousMonth&&a.publish("view-changed",a,["previous-year"])!==!1&&(a.viewStartDate.subtract("years",1),a.draw()),!1;if(s.hasClassName(t.parentNode,f.days)&&s.hasClassName(t,f.dayActive)&&(n=t.getAttribute("data-date"))){n=u(n,l.dayAttributeFormat).hours(12);if(a.publish("date-clicked",a,[n])!==!1)switch(l.mode){case"multiple":a.addSelected(n)||a.removeSelected(n);break;case"range":a.addSelected(n);break;case"single":default:a.addSelected(n)}return!1}return!1}),!(l.attachTo=s.$(l.attachTo))||l.attachTo.appendChild(c)};n.prototype={defaults:{attachTo:null,months:1,weekStart:0,direction:"any",directionScrolling:!0,viewStartDate:null,blackout:null,selected:null,mode:"single",format:null,subscribe:null,columnHeaderLength:2,titleFormat:"MMMM, YYYY",dayNumberFormat:"D",dayAttributeFormat:"YYYY-MM-DD",parseSplitDelimiter:/,\s*|\s+-\s+/,rangeDelimiter:" - ",multipleDelimiter:", ",dateClassMap:{}},classes:{container:"kalendae",calendar:"k-calendar",monthFirst:"k-first-month",monthMiddle:"k-middle-month",monthLast:"k-last-month",title:"k-title",previousMonth:"k-btn-previous-month",nextMonth:"k-btn-next-month",previousYear:"k-btn-previous-year",nextYear:"k-btn-next-year",caption:"k-caption",header:"k-header",days:"k-days",dayOutOfMonth:"k-out-of-month",dayActive:"k-active",daySelected:"k-selected",dayInRange:"k-range",dayToday:"k-today",monthSeparator:"k-separator",disablePreviousMonth:"k-disable-previous-month-btn",disableNextMonth:"k-disable-next-month-btn",disablePreviousYear:"k-disable-previous-year-btn",disableNextYear:"k-disable-next-year-btn"},disablePreviousMonth:!1,disableNextMonth:!1,disablePreviousYear:!1,disableNextYear:!1,directions:{past:function(e){return u(e).yearDay()>=t.yearDay()},"today-past":function(e){return u(e).yearDay()>t.yearDay()},any:function(e){return!1},"today-future":function(e){return u(e).yearDay()<t.yearDay()},future:function(e){return u(e).yearDay()<=t.yearDay()}},getSelectedAsDates:function(){var e=[],t=0,n=this._sel.length;for(;t<n;t++)e.push(this._sel[t].toDate());return e},getSelectedAsText:function(e){var t=[],n=0,r=this._sel.length;for(;n<r;n++)t.push(this._sel[n].format(e||this.settings.format||"YYYY-MM-DD"));return t},getSelectedRaw:function(){var e=[],t=0,n=this._sel.length;for(;t<n;t++)e.push(u(this._sel[t]));return e},getSelected:function(e){var t=this.getSelectedAsText(e);switch(this.settings.mode){case"range":return t.splice(2),t.join(this.settings.rangeDelimiter);case"multiple":return t.join(this.settings.multipleDelimiter);case"single":default:return t[0]}},isSelected:function(e){e=u(e).yearDay();if(e<1||!this._sel||this._sel.length<1)return!1;switch(this.settings.mode){case"range":var t=this._sel[0]?this._sel[0].yearDay():0,n=this._sel[1]?this._sel[1].yearDay():0;if(t===e||n===e)return 1;if(!t||!n)return 0;if(e>t&&e<n||t<n&&e<t&&e>n)return-1;return!1;case"multiple":var r=this._sel.length;while(r--)if(this._sel[r].yearDay()===e)return!0;return!1;case"single":default:return this._sel[0]&&this._sel[0].yearDay()===e}return!1},setSelected:function(e,t){this._sel=r(e,this.settings.parseSplitDelimiter,this.settings.format),this._sel.sort(function(e,t){return e.yearDay()-t.yearDay()}),t!==!1&&this.draw()},addSelected:function(e,t){e=u(e).hours(12);switch(this.settings.mode){case"multiple":if(!!this.isSelected(e))return!1;this._sel.push(e);break;case"range":this._sel.length!==1?this._sel=[e]:e.yearDay()>this._sel[0].yearDay()?this._sel[1]=e:this._sel=[e,this._sel[0]];break;case"single":default:this._sel=[e]}return this._sel.sort(function(e,t){return e.yearDay()-t.yearDay()}),this.publish("change",this),t!==!1&&this.draw(),!0},removeSelected:function(e,t){e=u(e).yearDay();var n=this._sel.length;while(n--)if(this._sel[n].yearDay()===e)return this._sel.splice(n,1),this.publish("change",this),t!==!1&&this.draw(),!0;return!1},draw:function(){var n=u(this.viewStartDate).hours(12),r,i=this.classes,o,a,f,l=0,c,h=0,p,d,v,m=this.settings;c=this.calendars.length;do{r=u(n).date(1),r.day(r.day()<this.settings.weekStart?this.settings.weekStart-7:this.settings.weekStart),o=this.calendars[l],o.caption.innerHTML=n.format(this.settings.titleFormat),h=0;do a=o.days[h],f=[],d=this.isSelected(r),d&&f.push({"-1":i.dayInRange,1:i.daySelected,"true":i.daySelected}[d]),r.month()!=n.month()?f.push(i.dayOutOfMonth):(!this.blackout(r)&&!this.direction(r)||d>0)&&f.push(i.dayActive),r.yearDay()===t.yearDay()&&f.push(i.dayToday),v=r.format(this.settings.dayAttributeFormat),m.dateClassMap[v]&&f.push(m.dateClassMap[v]),a.innerHTML=r.format(m.dayNumberFormat),a.className=f.join(" "),a.setAttribute("data-date",v),r.add("days",1);while(++h<42);n.add("months",1)}while(++l<c);if(m.directionScrolling){var g=-u().diff(n,"months");if(m.direction==="today-past"||m.direction==="past")g<0?(this.disableNextMonth=!1,s.removeClassName(this.container,i.disableNextMonth)):(this.disableNextMonth=!0,s.addClassName(this.container,i.disableNextMonth));else if(m.direction==="today-future"||m.direction==="future")g>=m.months?(this.disablePreviousMonth=!1,s.removeClassName(this.container,i.disablePreviousMonth)):(this.disablePreviousMonth=!0,s.addClassName(this.container,i.disablePreviousMonth));if(m.direction==="today-past"||m.direction==="past")n.add({y:1}).diff(u(),"months")<=0?(this.disableNextYear=!1,s.removeClassName(this.container,i.disableNextYear)):(this.disableNextYear=!0,s.addClassName(this.container,i.disableNextYear));else if(m.direction==="today-future"||m.direction==="future")n.subtract({y:1}).diff(u(),"months")-(m.months-1)>=0?(this.disablePreviousYear=!1,s.removeClassName(this.container,i.disablePreviousYear)):(this.disablePreviousYear=!0,s.addClassName(this.container,i.disablePreviousYear))}}};var r=function(e,t,n){var r=[];typeof e=="string"?e=e.split(t):s.isArray(e)||(e=[e]);var o=e.length;i=0;do e[i]&&r.push(u(e[i],n).hours(12));while(++i<o);return r};window.Kalendae=n;var s=n.util={isIE8:function(){return!!(/msie 8./i.test(navigator.appVersion)&&!/opera/i.test(navigator.userAgent)&&window.ActiveXObject&&XDomainRequest&&!window.msPerformance)},$:function(e){return typeof e=="string"?document.getElementById(e):e},$$:function(e){return document.querySelectorAll(e)},make:function(e,t,n){var r,i=document.createElement(e);if(!!t)for(r in t)t.hasOwnProperty(r)&&i.setAttribute(r,t[r]);return!n||n.appendChild(i),i},isVisible:function(e){return e.offsetWidth>0||e.offsetHeight>0},getStyle:function(e,t){var n;return e.currentStyle?n=e.currentStyle[t]:window.getComputedStyle&&(n=window.getComputedStyle(e,null)[t]),n},domReady:function(e){/in/.test(document.readyState)?setTimeout(function(){s.domReady(e)},9):e()},addEvent:function(e,t,n){var r=function(t){t=t||window.event;var r=t.target||t.srcElement,i=n.apply(e,[t,r]);return i===!1&&(t.preventDefault?t.preventDefault():(t.returnValue=!1,t.cancelBubble=!0)),i};return e.attachEvent?e.attachEvent("on"+t,r):e.addEventListener(t,r,!1),r},removeEvent:function(e,t,n){e.detachEvent?e.detachEvent("on"+t,n):e.removeEventListener(t,n,!1)},hasClassName:function(e,t){if(!(e=s.$(e)))return!1;var n=e.className;return n.length>0&&(n==t||(new RegExp("(^|\\s)"+t+"(\\s|$)")).test(n))},addClassName:function(e,t){if(!(e=s.$(e)))return;s.hasClassName(e,t)||(e.className+=(e.className?" ":"")+t)},removeClassName:function(e,t){if(!(e=s.$(e)))return;e.className=s.trimString(e.className.replace(new RegExp("(^|\\s+)"+t+"(\\s+|$)")," "))},isFixed:function(e){do if(s.getStyle(e,"position")==="fixed")return!0;while(e=e.offsetParent);return!1},getPosition:function(e,t){var n=e.offsetLeft,r=e.offsetTop,i={};if(!t)while(
e=e.offsetParent)n+=e.offsetLeft,r+=e.offsetTop;return i[0]=i.left=n,i[1]=i.top=r,i},getHeight:function(e){return e.offsetHeight||e.scrollHeight},getWidth:function(e){return e.offsetWidth||e.scrollWidth},trimString:function(e){return e.replace(/^\s+/,"").replace(/\s+$/,"")},merge:function(){var e=arguments[0]===!0,t={},n=e?1:0,r=function(t,n){if(typeof n!="object")return;for(var r in n)n.hasOwnProperty(r)&&(e&&typeof t[r]=="object"&&typeof n[r]=="object"?_update(t[r],n[r]):t[r]=n[r]);return t};for(;n<arguments.length;n++)r(t,arguments[n]);return t},isArray:function(e){return!(!e||!e.length||e.length===0||typeof e!="object"||!e.constructor||e.nodeType||e.item)}};n.util.domReady(function(){var e=s.$$(".auto-kal"),t=e.length,r;while(t--){r=e[t];var i=r.getAttribute("data-kal"),o=i==null||i==""?{}:(new Function("return {"+i+"};"))();r.tagName==="INPUT"?new n.Input(r,o):new n(s.merge({attachTo:r},o))}}),n.Input=function(e,t){var r=this.input=s.$(e),i;if(!r||r.tagName!=="INPUT")throw"First argument for Kalendae.Input must be an <input> element or a valid element id.";var o=this,u=o.classes;opts=o.settings=s.merge(o.defaults,t),opts.attachTo=window.document.body,opts.selected?i=!0:opts.selected=r.value,n.call(o,opts);if(opts.closeButton){var a=s.make("a",{"class":u.closeButton},o.container);s.addEvent(a,"click",function(){r.blur()})}i&&(r.value=o.getSelected());var f=o.container,l=!1;f.style.display="none",s.addClassName(f,u.positioned),s.addEvent(f,"mousedown",function(e,t){l=!0}),s.addEvent(window.document,"mousedown",function(e,t){l=!1}),s.addEvent(r,"focus",function(){o.setSelected(this.value),o.show()}),s.addEvent(r,"blur",function(){l?(l=!1,r.focus()):o.hide()}),s.addEvent(r,"keyup",function(e){o.setSelected(this.value)}),o.subscribe("change",function(){r.value=o.getSelected()})},n.Input.prototype=s.merge(n.prototype,{defaults:s.merge(n.prototype.defaults,{format:"MM/DD/YYYY",side:"bottom",closeButton:!0,offsetLeft:0,offsetTop:0}),classes:s.merge(n.prototype.classes,{positioned:"k-floating",closeButton:"k-btn-close"}),show:function(){var e=this.container,t=e.style,n=this.input,r=s.getPosition(n);t.display="";switch(opts.side){case"left":t.left=r.left-s.getWidth(e)+this.settings.offsetLeft+"px",t.top=r.top+this.settings.offsetTop+"px";break;case"right":t.left=r.left+s.getWidth(n)+"px",t.top=r.top+this.settings.offsetTop+"px";break;case"top":t.left=r.left+this.settings.offsetLeft+"px",t.top=r.top-s.getHeight(e)+this.settings.offsetTop+"px";break;case"bottom":default:t.left=r.left+this.settings.offsetLeft+"px",t.top=r.top+s.getHeight(n)+this.settings.offsetTop+"px"}t.position=s.isFixed(n)?"fixed":"absolute"},hide:function(){this.container.style.display="none"}});var o=function(e){e||(e=this);var t=e.c_||{};e.publish=function(e,n,r){var i=t[e],s=i?i.length:0,o;while(s--){o=i[s].apply(n,r||[]);if(typeof o=="boolean")return o}},e.subscribe=function(e,n,r){return t[e]||(t[e]=[]),r?t[e].push(n):t[e].unshift(n),[e,n]},e.unsubscribe=function(e){var n=t[e[0]],r=e[1],i=n?n.length:0;while(i--)n[i]===r&&n.splice(i,1)}},u=n.moment=function(e,t){function w(e,t){this._d=e,this._isUTC=!!t}function E(e,t){var n=e+"";while(n.length<t)n="0"+n;return n}function S(t,n,r,i){var s=typeof n=="string",o=s?{}:n,u,a,f,l;return s&&i&&(o[n]=+i),u=(o.ms||o.milliseconds||0)+(o.s||o.seconds||0)*1e3+(o.m||o.minutes||0)*6e4+(o.h||o.hours||0)*36e5,a=(o.d||o.days||0)+(o.w||o.weeks||0)*7,f=(o.M||o.months||0)+(o.y||o.years||0)*12,u&&t.setTime(+t+u*r),a&&t.setDate(t.getDate()+a*r),f&&(l=t.getDate(),t.setDate(1),t.setMonth(t.getMonth()+f*r),t.setDate(Math.min((new e(t.getFullYear(),t.getMonth()+1,0)).getDate(),l))),t}function x(e){return Object.prototype.toString.call(e)==="[object Array]"}function T(t){return new e(t[0],t[1]||0,t[2]||1,t[3]||0,t[4]||0,t[5]||0,t[6]||0)}function N(t,r){function g(r){var f,y;switch(r){case"M":return i+1;case"Mo":return i+1+v(i+1);case"MM":return E(i+1,2);case"MMM":return n.monthsShort[i];case"MMMM":return n.months[i];case"D":return s;case"Do":return s+v(s);case"DD":return E(s,2);case"DDD":return f=new e(o,i,s),y=new e(o,0,1),~~((f-y)/864e5+1.5);case"DDDo":return f=g("DDD"),f+v(f);case"DDDD":return E(g("DDD"),3);case"d":return u;case"do":return u+v(u);case"ddd":return n.weekdaysShort[u];case"dddd":return n.weekdays[u];case"w":return f=new e(o,i,s-u+5),y=new e(f.getFullYear(),0,4),~~((f-y)/864e5/7+1.5);case"wo":return f=g("w"),f+v(f);case"ww":return E(g("w"),2);case"YY":return E(o%100,2);case"YYYY":return o;case"a":return a>11?m.pm:m.am;case"A":return a>11?m.PM:m.AM;case"H":return a;case"HH":return E(a,2);case"h":return a%12||12;case"hh":return E(a%12||12,2);case"m":return h;case"mm":return E(h,2);case"s":return p;case"ss":return E(p,2);case"zz":case"z":return(t._d.toString().match(c)||[""])[0].replace(l,"");case"Z":return(d<0?"-":"+")+E(~~(Math.abs(d)/60),2)+":"+E(~~(Math.abs(d)%60),2);case"ZZ":return(d<0?"-":"+")+E(~~(10*Math.abs(d)/6),4);case"L":case"LL":case"LLL":case"LLLL":case"LT":return N(t,n.longDateFormat[r]);default:return r.replace(/(^\[)|(\\)|\]$/g,"")}}var i=t.month(),s=t.date(),o=t.year(),u=t.day(),a=t.hours(),h=t.minutes(),p=t.seconds(),d=-t.zone(),v=n.ordinal,m=n.meridiem;return r.replace(f,g)}function C(t,r){function v(e,t){var r;switch(e){case"M":case"MM":i[1]=~~t-1;break;case"MMM":case"MMMM":for(r=0;r<12;r++)if(n.monthsParse[r].test(t)){i[1]=r;break}break;case"D":case"DD":case"DDD":case"DDDD":i[2]=~~t;break;case"YY":t=~~t,i[0]=t+(t>70?1900:2e3);break;case"YYYY":i[0]=~~Math.abs(t);break;case"a":case"A":d=t.toLowerCase()==="pm";break;case"H":case"HH":case"h":case"hh":i[3]=~~t;break;case"m":case"mm":i[4]=~~t;break;case"s":case"ss":i[5]=~~t;break;case"Z":case"ZZ":u=!0,r=(t||"").match(g),r&&r[1]&&(s=~~r[1]),r&&r[2]&&(o=~~r[2]),r&&r[0]==="+"&&(s=-s,o=-o)}}var i=[0,0,1,0,0,0,0],s=0,o=0,u=!1,a=t.match(p),f=r.match(h),l=Math.min(a.length,f.length),c,d;for(c=0;c<l;c++)v(f[c],a[c]);return d&&i[3]<12&&(i[3]+=12),d===!1&&i[3]===12&&(i[3]=0),i[3]+=s,i[4]+=o,u?new e(e.UTC.apply({},i)):T(i)}function k(e,t){var n=Math.min(e.length,t.length),r=Math.abs(e.length-t.length),i=0,s;for(s=0;s<n;s++)~~e[s]!==~~t[s]&&i++;return i+r}function L(e,t){var n,r=e.match(p),i=[],s=99,o,u,a;for(o=0;o<t.length;o++)u=C(e,t[o]),a=k(r,N(new w(u),t[o]).match(p)),a<s&&(s=a,n=u);return n}function A(t){var n="YYYY-MM-DDT",r;if(d.exec(t)){for(r=0;r<3;r++)if(m[r][1].exec(t)){n+=m[r][0];break}return C(t,n+"Z")}return new e(t)}function O(e,t,r){var i=n.relativeTime[e];return typeof i=="function"?i(t||1,!!r,e):i.replace(/%d/i,t||1)}function M(e,t){var n=r(Math.abs(e)/1e3),i=r(n/60),s=r(i/60),o=r(s/24),u=r(o/365),a=n<45&&["s",n]||i===1&&["m"]||i<45&&["mm",i]||s===1&&["h"]||s<22&&["hh",s]||o===1&&["d"]||o<=25&&["dd",o]||o<=45&&["M"]||o<345&&["MM",r(o/30)]||u===1&&["y"]||["yy",u];return a[2]=t,O.apply({},a)}function _(e,t){n.fn[e]=function(e){var n=this._isUTC?"UTC":"";return typeof e!="undefined"?(this._d["set"+n+t](e),this):this._d["get"+n+t]()}}var n,r=Math.round,i={},s=typeof module!="undefined",o="months|monthsShort|monthsParse|weekdays|weekdaysShort|longDateFormat|calendar|relativeTime|ordinal|meridiem".split("|"),u,a=/^\/?Date\((\-?\d+)/i,f=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|dddd?|do?|w[o|w]?|YYYY|YY|a|A|hh?|HH?|mm?|ss?|zz?|ZZ?|LT|LL?L?L?)/g,l=/[^A-Z]/g,c=/\([A-Za-z ]+\)|:[0-9]{2} [A-Z]{3} /g,h=/(\\)?(MM?M?M?|dd?d?d|DD?D?D?|YYYY|YY|a|A|hh?|HH?|mm?|ss?|ZZ?|T)/g,p=/(\\)?([0-9]+|([a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+|([\+\-]\d\d:?\d\d))/gi,d=/\d{4}.\d\d.\d\d(T(\d\d(.\d\d(.\d\d)?)?)?([\+\-]\d\d:?\d\d)?)?/,v="YYYY-MM-DDTHH:mm:ssZ",m=[["HH:mm:ss",/T\d\d:\d\d:\d\d/],["HH:mm",/T\d\d:\d\d/],["HH",/T\d\d/]],g=/([\+\-]|\d\d)/gi,y="1.5.0",b="Month|Date|Hours|Minutes|Seconds|Milliseconds".split("|");n=function(n,r){if(n===null||n==="")return null;var i,s;return n&&n._d instanceof e?i=new e(+n._d):r?x(r)?i=L(n,r):i=C(n,r):(s=a.exec(n),i=n===t?new e:s?new e(+s[1]):n instanceof e?n:x(n)?T(n):typeof n=="string"?A(n):new e(n)),new w(i)},n.utc=function(t,r){return x(t)?new w(new e(e.UTC.apply({},t)),!0):r&&t?n(t+" 0",r+" Z").utc():n(t).utc()},n.humanizeDuration=function(e,t,r){var i=+e,s=n.relativeTime,o;switch(t){case"seconds":i*=1e3;break;case"minutes":i*=6e4;break;case"hours":i*=36e5;break;case"days":i*=864e5;break;case"weeks":i*=6048e5;break;case"months":i*=2592e6;break;case"years":i*=31536e6;break;default:r=!!t}return o=M(i,!r),r?(i<=0?s.past:s.future).replace(/%s/i,o):o},n.version=y,n.defaultFormat=v,n.lang=function(e,t){var r,u,a,f=[];if(t){for(r=0;r<12;r++)f[r]=new RegExp("^"+t.months[r]+"|^"+t.monthsShort[r].replace(".",""),"i");t.monthsParse=t.monthsParse||f,i[e]=t}if(i[e])for(r=0;r<o.length;r++)u=o[r],n[u]=i[e][u]||n[u];else s&&(a=require("./lang/"+e),n.lang(e,a))},n.lang("en",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},meridiem:{AM:"AM",am:"am",PM:"PM",pm:"pm"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},ordinal:function(e){var t=e%10;return~~(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th"}}),n.isMoment=function(e){return e instanceof w},n.fn=w.prototype={clone:function(){return n(this)},valueOf:function(){return+this._d},"native":function(){return this._d},toString:function(){return this._d.toString()},toDate:function(){return this._d},utc:function(){return this._isUTC=!0,this},local:function(){return this._isUTC=!1,this},format:function(e){return N(this,e?e:n.defaultFormat)},add:function(e,t){return this._d=S(this._d,e,1,t),this},subtract:function(e,t){return this._d=S(this._d,e,-1,t),this},diff:function(e,t,i){var s=n(e),o=(this.zone()-s.zone())*6e4,u=this._d-s._d-o,a=this.year()-s.year(),f=this.month()-s.month(),l=this.date()-s.date(),c;return t==="months"?c=a*12+f+l/30:t==="years"?c=a+f/12:c=t==="seconds"?u/1e3:t==="minutes"?u/6e4:t==="hours"?u/36e5:t==="days"?u/864e5:t==="weeks"?u/6048e5:u,i?c:r(c)},from:function(e,t){return n.humanizeDuration(this.diff(e),!t)},fromNow:function(e){return this.from(n(),e)},calendar:function(){var e=this.diff(n().sod(),"days",!0),t=n.calendar,r=t.sameElse,i=e<-6?r:e<-1?t.lastWeek:e<0?t.lastDay:e<1?t.sameDay:e<2?t.nextDay:e<7?t.nextWeek:r;return this.format(typeof i=="function"?i.apply(this):i)},isLeapYear:function(){var e=this.year();return e%4===0&&e%100!==0||e%400===0},isDST:function(){return this.zone()<n([this.year()]).zone()||this.zone()<n([this.year(),5]).zone()},day:function(e){var t=this._d.getDay();return typeof e=="undefined"?t:this.add({d:e-t})},sod:function(){return this.clone().hours(0).minutes(0).seconds(0).milliseconds(0)},eod:function(){return this.sod().add({d:1,ms:-1})},zone:function(){return this._isUTC?0:this._d.getTimezoneOffset()},daysInMonth:function(){return this.clone().month(this.month()+1).date(0).date()}};for(u=0;u<b.length;u++)_(b[u].toLowerCase(),b[u]);return _("year","FullYear"),n}(Date);u.fn.stripTime=function(){return this._d=new Date(Math.floor(this._d.valueOf()/864e5)*864e5),this},u.fn.yearDay=function(e){var t=Math.floor(this._d/864e5);return typeof e=="undefined"?t:this.add({d:e-t})},t=u().stripTime(),typeof jQuery!="undefined"&&(jQuery.fn.kalendae=function(e){return this.each(function(t,r){r.tagName==="INPUT"?$(r).data("kalendae",new n.Input(r,e)):$(r).data("kalendae",new n($.extend({},{attachTo:r},e)))}),this})}();