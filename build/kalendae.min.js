/********************************************************************
 *	Kalendae, a framework agnostic javascript date picker           *
 *	Copyright(c) 2012 Jarvis Badgley (chipersoft@gmail.com)         *
 *	http://github.com/ChiperSoft/Kalendae                           *
 *	Version 0.3                                                     *
 ********************************************************************/

(function(N){var p,q=function(a,c){if("function"===typeof document.addEventListener||b.isIE8()){var d=!1;try{d=a instanceof Element}catch(k){d=!!a&&1===d.nodeType}d||"string"===typeof a||(c=a);var e=this,f=e.classes,h=e.settings=b.merge(e.defaults,{attachTo:a},c||{}),d=e.container=b.make("div",{"class":f.container}),q=e.calendars=[],v=l().day(h.weekStart),r,n=[],g,m,z;g=[];var p;m=0;r=h.months;b.isIE8()&&b.addClassName(d,"ie8");for(m=7;m--;)n.push(v.format("ddd").substr(0,h.columnHeaderLength)),v.add("days",
1);C(e);if("object"===typeof h.subscribe)for(m in h.subscribe)h.subscribe.hasOwnProperty(m)&&e.subscribe(m,h.subscribe[m]);e._sel=[];h.selected&&e.setSelected(h.selected,!1);r=h.viewStartDate?l(h.viewStartDate,h.format):0<e._sel.length?l(e._sel[0]):l();e.viewStartDate=r.date(1);(r={past:h.months-1,"today-past":h.months-1,any:2<h.months?Math.floor(h.months/2):0,"today-future":0,future:0}[this.settings.direction])&&l().month()==l(e.viewStartDate).month()&&(e.viewStartDate=l(e.viewStartDate).subtract({M:r}).date(1));
if("function"===typeof h.blackout)e.blackout=h.blackout;else if(h.blackout){var w=A(h.blackout,h.parseSplitDelimiter);e.blackout=function(a){a=l(a).yearDay();if(1>a||!e._sel||1>e._sel.length)return!1;for(var d=w.length;d--;)if(w[d].yearDay()===a)return!0;return!1}}else e.blackout=function(){return!1};e.direction=e.directions[h.direction]?e.directions[h.direction]:e.directions.any;for(r=Math.max(h.months,1);r--;){g=b.make("div",{"class":f.calendar},d);g.setAttribute("data-cal-index",r);1<h.months&&
(r==Math.max(h.months-1,1)?b.addClassName(g,f.monthFirst):0===r?b.addClassName(g,f.monthLast):b.addClassName(g,f.monthMiddle));m=b.make("div",{"class":f.title},g);h.useYearNav||b.addClassName(m,f.disableYearNav);b.make("a",{"class":f.previousYear},m);b.make("a",{"class":f.previousMonth},m);b.make("a",{"class":f.nextYear},m);b.make("a",{"class":f.nextMonth},m);v=b.make("span",{"class":f.caption},m);z=b.make("div",{"class":f.header},g);m=0;do p=b.make("span",{},z),p.innerHTML=n[m];while(7>++m);z=b.make("div",
{"class":f.days},g);m=0;for(g=[];42>m++;)g.push(b.make("span",{},z));q.push({caption:v,days:g});r&&b.make("div",{"class":f.monthSeparator},d)}e.draw();b.addEvent(d,"mousedown",function(a,d){var c;if(b.hasClassName(d,f.nextMonth))e.disableNext||!1===e.publish("view-changed",e,["next-month"])||(e.viewStartDate.add("months",1),e.draw());else if(b.hasClassName(d,f.previousMonth))e.disablePreviousMonth||!1===e.publish("view-changed",e,["previous-month"])||(e.viewStartDate.subtract("months",1),e.draw());
else if(b.hasClassName(d,f.nextYear))e.disableNext||!1===e.publish("view-changed",e,["next-year"])||(e.viewStartDate.add("years",1),e.draw());else if(b.hasClassName(d,f.previousYear))e.disablePreviousMonth||!1===e.publish("view-changed",e,["previous-year"])||(e.viewStartDate.subtract("years",1),e.draw());else if(b.hasClassName(d.parentNode,f.days)&&(b.hasClassName(d,f.dayActive)&&(c=d.getAttribute("data-date")))&&(c=l(c,h.dayAttributeFormat).hours(12),!1!==e.publish("date-clicked",e,[c])))switch(h.mode){case "multiple":e.addSelected(c)||
e.removeSelected(c);break;case "range":e.addSelected(c);break;default:e.addSelected(c)}return!1});(h.attachTo=b.$(h.attachTo))&&h.attachTo.appendChild(d)}};q.prototype={defaults:{attachTo:null,months:1,weekStart:0,direction:"any",directionScrolling:!0,viewStartDate:null,blackout:null,selected:null,mode:"single",dayOutOfMonthClickable:!1,format:null,subscribe:null,columnHeaderLength:2,titleFormat:"MMMM, YYYY",dayNumberFormat:"D",dayAttributeFormat:"YYYY-MM-DD",parseSplitDelimiter:/,\s*|\s+-\s+/,rangeDelimiter:" - ",
multipleDelimiter:", ",useYearNav:!0,dateClassMap:{}},classes:{container:"kalendae",calendar:"k-calendar",monthFirst:"k-first-month",monthMiddle:"k-middle-month",monthLast:"k-last-month",title:"k-title",previousMonth:"k-btn-previous-month",nextMonth:"k-btn-next-month",previousYear:"k-btn-previous-year",nextYear:"k-btn-next-year",caption:"k-caption",header:"k-header",days:"k-days",dayOutOfMonth:"k-out-of-month",dayInMonth:"k-in-month",dayActive:"k-active",daySelected:"k-selected",dayInRange:"k-range",
dayToday:"k-today",monthSeparator:"k-separator",disablePreviousMonth:"k-disable-previous-month-btn",disableNextMonth:"k-disable-next-month-btn",disablePreviousYear:"k-disable-previous-year-btn",disableNextYear:"k-disable-next-year-btn",disableYearNav:"k-disable-year-nav"},disablePreviousMonth:!1,disableNextMonth:!1,disablePreviousYear:!1,disableNextYear:!1,directions:{past:function(a){return l(a).yearDay()>=p.yearDay()},"today-past":function(a){return l(a).yearDay()>p.yearDay()},any:function(a){return!1},
"today-future":function(a){return l(a).yearDay()<p.yearDay()},future:function(a){return l(a).yearDay()<=p.yearDay()}},getSelectedAsDates:function(){for(var a=[],c=0,d=this._sel.length;c<d;c++)a.push(this._sel[c].toDate());return a},getSelectedAsText:function(a){for(var c=[],d=0,k=this._sel.length;d<k;d++)c.push(this._sel[d].format(a||this.settings.format||"YYYY-MM-DD"));return c},getSelectedRaw:function(){for(var a=[],c=0,d=this._sel.length;c<d;c++)a.push(l(this._sel[c]));return a},getSelected:function(a){a=
this.getSelectedAsText(a);switch(this.settings.mode){case "range":return a.splice(2),a.join(this.settings.rangeDelimiter);case "multiple":return a.join(this.settings.multipleDelimiter);default:return a[0]}},isSelected:function(a){a=l(a).yearDay();if(1>a||!this._sel||1>this._sel.length)return!1;switch(this.settings.mode){case "range":var c=this._sel[0]?this._sel[0].yearDay():0,d=this._sel[1]?this._sel[1].yearDay():0;return c===a||d===a?1:c&&d?a>c&&a<d||c<d&&a<c&&a>d?-1:!1:0;case "multiple":for(c=this._sel.length;c--;)if(this._sel[c].yearDay()===
a)return!0;return!1;default:return this._sel[0]&&this._sel[0].yearDay()===a}},setSelected:function(a,c){this._sel=A(a,this.settings.parseSplitDelimiter,this.settings.format);this._sel.sort(function(a,c){return a.yearDay()-c.yearDay()});!1!==c&&this.draw()},addSelected:function(a,c){a=l(a).hours(12);this.settings.dayOutOfMonthClickable&&"range"!==this.settings.mode&&this.makeSelectedDateVisible(a);switch(this.settings.mode){case "multiple":if(this.isSelected(a))return!1;this._sel.push(a);break;case "range":1!==
this._sel.length?this._sel=[a]:a.yearDay()>this._sel[0].yearDay()?this._sel[1]=a:this._sel=[a,this._sel[0]];break;default:this._sel=[a]}this._sel.sort(function(a,c){return a.yearDay()-c.yearDay()});this.publish("change",this);!1!==c&&this.draw();return!0},makeSelectedDateVisible:function(a){outOfViewMonth=l(a).date("1").diff(this.viewStartDate,"months");0>outOfViewMonth?this.viewStartDate.subtract("months",1):0<outOfViewMonth&&outOfViewMonth>=this.settings.months&&this.viewStartDate.add("months",
1)},removeSelected:function(a,c){a=l(a).yearDay();for(var d=this._sel.length;d--;)if(this._sel[d].yearDay()===a)return this._sel.splice(d,1),this.publish("change",this),!1!==c&&this.draw(),!0;return!1},draw:function(){var a=l(this.viewStartDate).hours(12),c,d=this.classes,k,e,f,h=0,q,v=0,r,n=this.settings;q=this.calendars.length;do{c=l(a).date(1);c.day(c.day()<this.settings.weekStart?this.settings.weekStart-7:this.settings.weekStart);k=this.calendars[h];k.caption.innerHTML=a.format(this.settings.titleFormat);
v=0;do e=k.days[v],f=[],(r=this.isSelected(c))&&f.push({"-1":d.dayInRange,1:d.daySelected,"true":d.daySelected}[r]),c.month()!=a.month()?f.push(d.dayOutOfMonth):f.push(d.dayInMonth),(!(this.blackout(c)||this.direction(c)||c.month()!=a.month()&&!1===n.dayOutOfMonthClickable)||0<r)&&f.push(d.dayActive),c.yearDay()===p.yearDay()&&f.push(d.dayToday),r=c.format(this.settings.dayAttributeFormat),n.dateClassMap[r]&&f.push(n.dateClassMap[r]),e.innerHTML=c.format(n.dayNumberFormat),e.className=f.join(" "),
e.setAttribute("data-date",r),c.add("days",1);while(42>++v);a.add("months",1)}while(++h<q);if(n.directionScrolling){c=-l().diff(a,"months");if("today-past"===n.direction||"past"===n.direction)0>c?(this.disableNextMonth=!1,b.removeClassName(this.container,d.disableNextMonth)):(this.disableNextMonth=!0,b.addClassName(this.container,d.disableNextMonth));else if("today-future"===n.direction||"future"===n.direction)c>=n.months?(this.disablePreviousMonth=!1,b.removeClassName(this.container,d.disablePreviousMonth)):
(this.disablePreviousMonth=!0,b.addClassName(this.container,d.disablePreviousMonth));if("today-past"===n.direction||"past"===n.direction)0>=a.add({y:1}).diff(l(),"months")?(this.disableNextYear=!1,b.removeClassName(this.container,d.disableNextYear)):(this.disableNextYear=!0,b.addClassName(this.container,d.disableNextYear));else if("today-future"===n.direction||"future"===n.direction)0<=a.subtract({y:1}).diff(l(),"months")-(n.months-1)?(this.disablePreviousYear=!1,b.removeClassName(this.container,
d.disablePreviousYear)):(this.disablePreviousYear=!0,b.addClassName(this.container,d.disablePreviousYear))}}};var A=function(a,c,d){var k=[];"string"===typeof a?a=a.split(c):b.isArray(a)||(a=[a]);c=a.length;i=0;do a[i]&&k.push(l(a[i],d).hours(12));while(++i<c);return k};window.Kalendae=q;var b=q.util={isIE8:function(){return!(!/msie 8./i.test(navigator.appVersion)||/opera/i.test(navigator.userAgent)||!window.ActiveXObject||!XDomainRequest||window.msPerformance)},$:function(a){return"string"==typeof a?
document.getElementById(a):a},$$:function(a){return document.querySelectorAll(a)},make:function(a,c,d){var b;a=document.createElement(a);if(c)for(b in c)c.hasOwnProperty(b)&&a.setAttribute(b,c[b]);d&&d.appendChild(a);return a},isVisible:function(a){return 0<a.offsetWidth||0<a.offsetHeight},getStyle:function(a,c){var d;a.currentStyle?d=a.currentStyle[c]:window.getComputedStyle&&(d=(d=window.getComputedStyle(a,null))?d[c]:"");return d},domReady:function(a){/in/.test(document.readyState)?setTimeout(function(){b.domReady(a)},
9):a()},addEvent:function(a,c,d){var b=function(c){c=c||window.event;var b=d.apply(a,[c,c.target||c.srcElement]);!1===b&&(c.preventDefault?c.preventDefault():(c.returnValue=!1,c.cancelBubble=!0));return b};a.attachEvent?a.attachEvent("on"+c,b):a.addEventListener(c,b,!1);return b},removeEvent:function(a,c,d){a.detachEvent?a.detachEvent("on"+c,d):a.removeEventListener(c,d,!1)},hasClassName:function(a,c){if(!(a=b.$(a)))return!1;var d=a.className;return 0<d.length&&(d==c||RegExp("(^|\\s)"+c+"(\\s|$)").test(d))},
addClassName:function(a,c){(a=b.$(a))&&!b.hasClassName(a,c)&&(a.className+=(a.className?" ":"")+c)},removeClassName:function(a,c){if(a=b.$(a))a.className=b.trimString(a.className.replace(RegExp("(^|\\s+)"+c+"(\\s+|$)")," "))},isFixed:function(a){do if("fixed"===b.getStyle(a,"position"))return!0;while(a=a.offsetParent);return!1},scrollContainer:function(a){do{var c=b.getStyle(a,"overflow");if("auto"===c||"scroll"===c)return a}while((a=a.parentNode)&&a!=window.document.body);return null},getPosition:function(a,
c){var d=a.offsetLeft,b=a.offsetTop,e={};if(!c)for(;a=a.offsetParent;)d+=a.offsetLeft,b+=a.offsetTop;e[0]=e.left=d;e[1]=e.top=b;return e},getHeight:function(a){return a.offsetHeight||a.scrollHeight},getWidth:function(a){return a.offsetWidth||a.scrollWidth},trimString:function(a){return a.replace(/^\s+/,"").replace(/\s+$/,"")},merge:function(){for(var a=!0===arguments[0],c={},d=a?1:0;d<arguments.length;d++){var b=c,e=arguments[d];if("object"===typeof e){var f=void 0;for(f in e)e.hasOwnProperty(f)&&
(a&&"object"===typeof b[f]&&"object"===typeof e[f]?_update(b[f],e[f]):b[f]=e[f])}}return c},isArray:function(a){return!(!a||!a.length||0===a.length||"object"!==typeof a||!a.constructor||a.nodeType||a.item)}};"function"===typeof document.addEventListener&&q.util.domReady(function(){for(var a=b.$$(".auto-kal"),c=a.length,d,k;c--;)d=a[c],k=d.getAttribute("data-kal"),k=null==k||""==k?{}:(new Function("return {"+k+"};"))(),"INPUT"===d.tagName?new q.Input(d,k):new q(b.merge(k,{attachTo:d}))});q.Input=function(a,
c){if("function"===typeof document.addEventListener||b.isIE8()){var d=this.input=b.$(a),k;if(!d||"INPUT"!==d.tagName)throw"First argument for Kalendae.Input must be an <input> element or a valid element id.";var e=this,f=e.classes;opts=e.settings=b.merge(e.defaults,c);this._events={};opts.attachTo=window.document.body;opts.selected?k=!0:opts.selected=d.value;q.call(e,opts);if(opts.closeButton){var h=b.make("a",{"class":f.closeButton},e.container);b.addEvent(h,"click",function(){d.blur()})}k&&(d.value=
e.getSelected());k=e.container;var l=!1;k.style.display="none";b.addClassName(k,f.positioned);this._events.containerMouseDown=b.addEvent(k,"mousedown",function(a,d){l=!0});this._events.documentMousedown=b.addEvent(window.document,"mousedown",function(a,d){l=!1});this._events.inputFocus=b.addEvent(d,"focus",function(){e.setSelected(this.value);e.show()});this._events.inputBlur=b.addEvent(d,"blur",function(){l?(l=!1,d.focus()):e.hide()});this._events.inputKeyup=b.addEvent(d,"keyup",function(a){e.setSelected(this.value)});
(f=b.scrollContainer(d))&&b.addEvent(f,"scroll",function(a){d.blur()});e.subscribe("change",function(){d.value=e.getSelected()})}};q.Input.prototype=b.merge(q.prototype,{defaults:b.merge(q.prototype.defaults,{format:"MM/DD/YYYY",side:"bottom",closeButton:!0,offsetLeft:0,offsetTop:0}),classes:b.merge(q.prototype.classes,{positioned:"k-floating",closeButton:"k-btn-close"}),show:function(){var a=this.container,c=a.style,d=this.input,k=b.getPosition(d),e=b.scrollContainer(d),e=e?e.scrollTop:0;c.display=
"";switch(opts.side){case "left":c.left=k.left-b.getWidth(a)+this.settings.offsetLeft+"px";c.top=k.top+this.settings.offsetTop-e+"px";break;case "right":c.left=k.left+b.getWidth(d)+"px";c.top=k.top+this.settings.offsetTop-e+"px";break;case "top":c.left=k.left+this.settings.offsetLeft+"px";c.top=k.top-b.getHeight(a)+this.settings.offsetTop-e+"px";break;default:c.left=k.left+this.settings.offsetLeft+"px",c.top=k.top+b.getHeight(d)+this.settings.offsetTop-e+"px"}c.position=b.isFixed(d)?"fixed":"absolute";
this.publish("show",this)},hide:function(){this.container.style.display="none";this.publish("hide",this)},destroy:function(){var a=this.input;b.removeEvent(this.container,"mousedown",this._events.containerMousedown);b.removeEvent(window.document,"mousedown",this._events.documentMousedown);b.removeEvent(a,"focus",this._events.inputFocus);b.removeEvent(a,"blur",this._events.inputBlur);b.removeEvent(a,"keyup",this._events.inputKeyup)}});var C=function(a){a||(a=this);var c=a.c_||{};a.publish=function(a,
b,e){for(var f=(a=c[a])?a.length:0,h;f--;)if(h=a[f].apply(b,e||[]),"boolean"===typeof h)return h};a.subscribe=function(a,b,e){c[a]||(c[a]=[]);e?c[a].push(b):c[a].unshift(b);return[a,b]};a.unsubscribe=function(a){var b=c[a[0]];a=a[1];for(var e=b?b.length:0;e--;)b[e]===a&&b.splice(e,1)}},l=q.moment=function(a,c){function d(a,c){this._d=a;this._isUTC=!!c}function b(a,c){for(var d=a+"";d.length<c;)d="0"+d;return d}function e(u,c,d,b){var e="string"===typeof c,f=e?{}:c;e&&b&&(f[c]=+b);c=(f.ms||f.milliseconds||
0)+1E3*(f.s||f.seconds||0)+6E4*(f.m||f.minutes||0)+36E5*(f.h||f.hours||0);b=(f.d||f.days||0)+7*(f.w||f.weeks||0);f=(f.M||f.months||0)+12*(f.y||f.years||0);c&&u.setTime(+u+c*d);b&&u.setDate(u.getDate()+b*d);f&&(c=u.getDate(),u.setDate(1),u.setMonth(u.getMonth()+f*d),u.setDate(Math.min((new a(u.getFullYear(),u.getMonth()+1,0)).getDate(),c)));return u}function f(a){return"[object Array]"===Object.prototype.toString.call(a)}function h(c){return new a(c[0],c[1]||0,c[2]||1,c[3]||0,c[4]||0,c[5]||0,c[6]||
0)}function l(c,d){function e(d){var B;switch(d){case "M":return f+1;case "Mo":return f+1+t(f+1);case "MM":return b(f+1,2);case "MMM":return g.monthsShort[f];case "MMMM":return g.months[f];case "D":return h;case "Do":return h+t(h);case "DD":return b(h,2);case "DDD":return d=new a(m,f,h),B=new a(m,0,1),~~((d-B)/864E5+1.5);case "DDDo":return d=e("DDD"),d+t(d);case "DDDD":return b(e("DDD"),3);case "d":return q;case "do":return q+t(q);case "ddd":return g.weekdaysShort[q];case "dddd":return g.weekdays[q];
case "w":return d=new a(m,f,h-q+5),B=new a(d.getFullYear(),0,4),~~((d-B)/864E5/7+1.5);case "wo":return d=e("w"),d+t(d);case "ww":return b(e("w"),2);case "YY":return b(m%100,2);case "YYYY":return m;case "a":return 11<y?s.pm:s.am;case "A":return 11<y?s.PM:s.AM;case "H":return y;case "HH":return b(y,2);case "h":return y%12||12;case "hh":return b(y%12||12,2);case "m":return r;case "mm":return b(r,2);case "s":return n;case "ss":return b(n,2);case "zz":case "z":return(c._d.toString().match(I)||[""])[0].replace(J,
"");case "Z":return(0>p?"-":"+")+b(~~(Math.abs(p)/60),2)+":"+b(~~(Math.abs(p)%60),2);case "ZZ":return(0>p?"-":"+")+b(~~(10*Math.abs(p)/6),4);case "L":case "LL":case "LLL":case "LLLL":case "LT":return l(c,g.longDateFormat[d]);default:return d.replace(/(^\[)|(\\)|\]$/g,"")}}var f=c.month(),h=c.date(),m=c.year(),q=c.day(),y=c.hours(),r=c.minutes(),n=c.seconds(),p=-c.zone(),t=g.ordinal,s=g.meridiem;return d.replace(H,e)}function q(c,d){var b=[0,0,1,0,0,0,0],e=0,f=0,l=!1,k=c.match(E),m=d.match(K),r=Math.min(k.length,
m.length),n,p;for(n=0;n<r;n++){var t=k[n],s=void 0;switch(m[n]){case "M":case "MM":b[1]=~~t-1;break;case "MMM":case "MMMM":for(s=0;12>s;s++)if(g.monthsParse[s].test(t)){b[1]=s;break}break;case "D":case "DD":case "DDD":case "DDDD":b[2]=~~t;break;case "YY":t=~~t;b[0]=t+(70<t?1900:2E3);break;case "YYYY":b[0]=~~Math.abs(t);break;case "a":case "A":p="pm"===t.toLowerCase();break;case "H":case "HH":case "h":case "hh":b[3]=~~t;break;case "m":case "mm":b[4]=~~t;break;case "s":case "ss":b[5]=~~t;break;case "Z":case "ZZ":l=
!0,(s=(t||"").match(L))&&s[1]&&(e=~~s[1]),s&&s[2]&&(f=~~s[2]),s&&"+"===s[0]&&(e=-e,f=-f)}}p&&12>b[3]&&(b[3]+=12);!1===p&&12===b[3]&&(b[3]=0);b[3]+=e;b[4]+=f;return l?new a(a.UTC.apply({},b)):h(b)}function r(a,c,d){var b=g.relativeTime[a];return"function"===typeof b?b(c||1,!!d,a):b.replace(/%d/i,c||1)}function n(a,c){g.fn[a]=function(a){var d=this._isUTC?"UTC":"";return"undefined"!==typeof a?(this._d["set"+d+c](a),this):this._d["get"+d+c]()}}var g,m=Math.round,p={},A="undefined"!==typeof module,w=
"months monthsShort monthsParse weekdays weekdaysShort longDateFormat calendar relativeTime ordinal meridiem".split(" "),x,C=/^\/?Date\((\-?\d+)/i,H=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|dddd?|do?|w[o|w]?|YYYY|YY|a|A|hh?|HH?|mm?|ss?|zz?|ZZ?|LT|LL?L?L?)/g,J=/[^A-Z]/g,I=/\([A-Za-z ]+\)|:[0-9]{2} [A-Z]{3} /g,K=/(\\)?(MM?M?M?|dd?d?d|DD?D?D?|YYYY|YY|a|A|hh?|HH?|mm?|ss?|ZZ?|T)/g,E=/(\\)?([0-9]+|([a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+|([\+\-]\d\d:?\d\d))/gi,M=/\d{4}.\d\d.\d\d(T(\d\d(.\d\d(.\d\d)?)?)?([\+\-]\d\d:?\d\d)?)?/,
G=[["HH:mm:ss",/T\d\d:\d\d:\d\d/],["HH:mm",/T\d\d:\d\d/],["HH",/T\d\d/]],L=/([\+\-]|\d\d)/gi,F="Month Date Hours Minutes Seconds Milliseconds".split(" ");g=function(b,e){if(null===b||""===b)return null;var g;if(b&&b._d instanceof a)g=new a(+b._d);else if(e)if(f(e)){var k=b.match(E),m=99,n,r,p;for(n=0;n<e.length;n++){r=q(b,e[n]);p=k;for(var D=l(new d(r),e[n]).match(E),w=Math.min(p.length,D.length),x=Math.abs(p.length-D.length),t=0,s=void 0,s=0;s<w;s++)~~p[s]!==~~D[s]&&t++;p=t+x;p<m&&(m=p,g=r)}}else g=
q(b,e);else if(g=C.exec(b),b===c)g=new a;else if(g)g=new a(+g[1]);else if(b instanceof a)g=b;else if(f(b))g=h(b);else if("string"===typeof b)if(g="YYYY-MM-DDT",M.exec(b)){for(k=0;3>k;k++)if(G[k][1].exec(b)){g+=G[k][0];break}g=q(b,g+"Z")}else g=new a(b);else g=new a(b);return new d(g)};g.utc=function(b,c){return f(b)?new d(new a(a.UTC.apply({},b)),!0):c&&b?g(b+" 0",c+" Z").utc():g(b).utc()};g.humanizeDuration=function(a,b,c){a=+a;var d=g.relativeTime;switch(b){case "seconds":a*=1E3;break;case "minutes":a*=
6E4;break;case "hours":a*=36E5;break;case "days":a*=864E5;break;case "weeks":a*=6048E5;break;case "months":a*=2592E6;break;case "years":a*=31536E6;break;default:c=!!b}b=!c;var e=m(Math.abs(a)/1E3),f=m(e/60),h=m(f/60),k=m(h/24),l=m(k/365),e=45>e&&["s",e]||1===f&&["m"]||45>f&&["mm",f]||1===h&&["h"]||22>h&&["hh",h]||1===k&&["d"]||25>=k&&["dd",k]||45>=k&&["M"]||345>k&&["MM",m(k/30)]||1===l&&["y"]||["yy",l];e[2]=b;b=r.apply({},e);return c?(0>=a?d.past:d.future).replace(/%s/i,b):b};g.version="1.5.0";g.defaultFormat=
"YYYY-MM-DDTHH:mm:ssZ";g.lang=function(a,b){var c,d;d=[];if(b){for(c=0;12>c;c++)d[c]=RegExp("^"+b.months[c]+"|^"+b.monthsShort[c].replace(".",""),"i");b.monthsParse=b.monthsParse||d;p[a]=b}if(p[a])for(c=0;c<w.length;c++)d=w[c],g[d]=p[a][d]||g[d];else A&&(c=require("./lang/"+a),g.lang(a,c))};g.lang("en",{months:"January February March April May June July August September October November December".split(" "),monthsShort:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),weekdays:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),
weekdaysShort:"Sun Mon Tue Wed Thu Fri Sat".split(" "),longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},meridiem:{AM:"AM",am:"am",PM:"PM",pm:"pm"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",
M:"a month",MM:"%d months",y:"a year",yy:"%d years"},ordinal:function(a){var b=a%10;return 1===~~(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th"}});g.isMoment=function(a){return a instanceof d};g.fn=d.prototype={clone:function(){return g(this)},valueOf:function(){return+this._d},"native":function(){return this._d},toString:function(){return this._d.toString()},toDate:function(){return this._d},utc:function(){this._isUTC=!0;return this},local:function(){this._isUTC=!1;return this},format:function(a){return l(this,
a?a:g.defaultFormat)},add:function(a,b){this._d=e(this._d,a,1,b);return this},subtract:function(a,b){this._d=e(this._d,a,-1,b);return this},diff:function(a,b,c){a=g(a);var d=6E4*(this.zone()-a.zone()),d=this._d-a._d-d,e=this.year()-a.year(),f=this.month()-a.month();a=this.date()-a.date();b="months"===b?12*e+f+a/30:"years"===b?e+f/12:"seconds"===b?d/1E3:"minutes"===b?d/6E4:"hours"===b?d/36E5:"days"===b?d/864E5:"weeks"===b?d/6048E5:d;return c?b:m(b)},from:function(a,b){return g.humanizeDuration(this.diff(a),
!b)},fromNow:function(a){return this.from(g(),a)},calendar:function(){var a=this.diff(g().sod(),"days",!0),b=g.calendar,c=b.sameElse,a=-6>a?c:-1>a?b.lastWeek:0>a?b.lastDay:1>a?b.sameDay:2>a?b.nextDay:7>a?b.nextWeek:c;return this.format("function"===typeof a?a.apply(this):a)},isLeapYear:function(){var a=this.year();return 0===a%4&&0!==a%100||0===a%400},isDST:function(){return this.zone()<g([this.year()]).zone()||this.zone()<g([this.year(),5]).zone()},day:function(a){var b=this._d.getDay();return"undefined"===
typeof a?b:this.add({d:a-b})},sod:function(){return this.clone().hours(0).minutes(0).seconds(0).milliseconds(0)},eod:function(){return this.sod().add({d:1,ms:-1})},zone:function(){return this._isUTC?0:this._d.getTimezoneOffset()},daysInMonth:function(){return this.clone().month(this.month()+1).date(0).date()}};for(x=0;x<F.length;x++)n(F[x].toLowerCase(),F[x]);n("year","FullYear");return g}(Date);l.fn.stripTime=function(){this._d=new Date(864E5*Math.floor(this._d.valueOf()/864E5));return this};l.fn.yearDay=
function(a){var b=Math.floor(this._d/864E5);return"undefined"===typeof a?b:this.add({d:a-b})};p=l().stripTime();"undefined"!==typeof jQuery&&"function"===typeof document.addEventListener&&(jQuery.fn.kalendae=function(a){this.each(function(b,d){"INPUT"===d.tagName?$(d).data("kalendae",new q.Input(d,a)):$(d).data("kalendae",new q($.extend({},{attachTo:d},a)))});return this})})();
